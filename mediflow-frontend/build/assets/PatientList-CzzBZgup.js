import{j as e}from"./vendor-ui-U3Ba6Q2R.js";import{a as s}from"./vendor-react-BE6zuAE5.js";import{p as a,B as r,I as t,C as l,r as n,s as i,w as d,v as c,A as m,n as o,m as x,q as h,z as j,t as u}from"./dashboard-Bz_aPqVj.js";import{H as p,K as g,E as f,L as N,P as v,M as b,T as w,v as y,b as C,s as L,h as A}from"./vendor-icons-MnWTdEGO.js";import"./appointments-CF8odzyl.js";import"./vendor-utils-DkKPvr0p.js";const B=()=>{const{user:B}=a(),[P,S]=s.useState(""),[z,F]=s.useState(null),[G,O]=s.useState([]),[_,D]=s.useState(!0);s.useEffect(()=>{B&&(async()=>{try{if(D(!0),"doctor"===B?.role?.toLowerCase()){const e=(await h()).data||[],s=new Map;e.forEach(e=>{const a=e.patientId;a&&"object"==typeof a&&a._id&&s.set(a._id,a)});const a=Array.from(s.values());O(a)}else{const e=await j();O(e.data.data||[])}}catch(e){403===e.response?.status||401===e.response?.status?(u.error("You do not have permission to view patients"),O([])):(u.error("Failed to load patients. Please try again."),O([]))}finally{D(!1)}})()},[B]);const M=(()=>{let e=G;return P&&(e=e.filter(e=>e.name?.toLowerCase().includes(P.toLowerCase())||e.email?.toLowerCase().includes(P.toLowerCase())||e.phone?.includes(P))),e})(),Y=z?G.find(e=>e._id===z):null,E=e=>({"A+":"bg-red-100 text-red-800 border border-red-200","A-":"bg-red-200 text-red-900 border border-red-300","B+":"bg-emerald-100 text-emerald-800 border border-emerald-200","B-":"bg-emerald-200 text-emerald-900 border border-emerald-300","O+":"bg-green-100 text-green-800 border border-green-200","O-":"bg-green-200 text-green-900 border border-green-300","AB+":"bg-teal-100 text-teal-800 border border-teal-200","AB-":"bg-teal-200 text-teal-900 border border-teal-300"}[e]||"bg-gray-100 text-gray-800 border border-gray-200");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"doctor"===B?.role?.toLowerCase()?"My Patients":"All Patients"}),e.jsx("p",{className:"text-muted-foreground",children:"doctor"===B?.role?.toLowerCase()?"Patients assigned to your care":"Manage patient information and records"})]}),"receptionist"===B?.role?.toLowerCase()&&e.jsxs(r,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(p,{className:"mr-2 h-4 w-4"}),"Add New Patient"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(g,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-green-500"}),e.jsx(t,{placeholder:"Search patients by name, email, or phone...",value:P,onChange:e=>S(e.target.value),className:"pl-10 border-green-200 focus:border-green-500 focus:ring-green-500"})]}),e.jsxs(r,{variant:"outline",className:"border-green-200 text-green-700 hover:bg-green-50",children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),"Filter"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsx(i,{children:"Patient List"}),e.jsxs(d,{children:[M.length," patients found"]})]}),e.jsx(c,{children:_?e.jsxs("div",{className:"flex justify-center items-center py-10",children:[e.jsx(N,{className:"h-8 w-8 animate-spin text-emerald-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading patients..."})]}):e.jsxs("div",{className:"space-y-4",children:[M.map(s=>{const a=z===s._id;return e.jsx("div",{className:"p-4 border rounded-lg cursor-pointer transition-colors "+(a?"border-blue-500 bg-blue-50":"hover:bg-muted"),onClick:()=>F(s._id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(m,{className:"h-12 w-12",children:e.jsx(o,{children:s.name.split(" ").map(e=>e[0]).join("")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium",children:s.name}),s.bloodGroup&&e.jsx(x,{className:E(s.bloodGroup),children:s.bloodGroup})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground mt-1",children:[s.dateOfBirth&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[(new Date).getFullYear()-new Date(s.dateOfBirth).getFullYear()," years old"]}),e.jsx("span",{children:"â€¢"})]}),s.gender&&e.jsx("span",{className:"capitalize",children:s.gender})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground mt-1",children:[s.phone&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),s.phone]}),s.email&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-3 w-3 mr-1"}),s.email]})]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[s.allergies&&s.allergies.length>0&&e.jsxs(x,{variant:"destructive",className:"text-xs",children:[e.jsx(w,{className:"h-3 w-3 mr-1"}),"Allergies"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",size:"sm",children:"View Profile"}),"receptionist"===B?.role?.toLowerCase()&&e.jsx(r,{size:"sm",children:"Schedule"})]})]})]})},s._id)}),0===M.length&&!_&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(g,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:P?"No patients found matching your search":"No patients found"})]})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:Y?e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsxs(i,{className:"flex items-center",children:[e.jsx(m,{className:"h-8 w-8 mr-2",children:e.jsx(o,{children:Y.name.split(" ").map(e=>e[0]).join("")})}),Y.name]}),e.jsx(d,{children:"Patient Details"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Contact Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-4 w-4 mr-2 text-muted-foreground"}),Y.phone]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2 text-muted-foreground"}),Y.email]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(y,{className:"h-4 w-4 mr-2 text-muted-foreground mt-0.5"}),e.jsx("span",{children:Y.address})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Medical Information"}),e.jsxs("div",{className:"space-y-2",children:[Y.bloodGroup&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Blood Type:"}),e.jsx(x,{className:E(Y.bloodGroup),children:Y.bloodGroup})]}),Y.dateOfBirth&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Age:"}),e.jsxs("span",{children:[(new Date).getFullYear()-new Date(Y.dateOfBirth).getFullYear()," years"]})]}),Y.gender&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Gender:"}),e.jsx("span",{className:"capitalize",children:Y.gender})]})]})]}),Y.allergies&&Y.allergies.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center text-red-600",children:[e.jsx(w,{className:"h-4 w-4 mr-1"}),"Allergies"]}),e.jsx("div",{className:"space-y-1",children:Y.allergies.map((s,a)=>e.jsx(x,{variant:"destructive",className:"mr-1 mb-1",children:s},a))})]}),Y.emergencyContact&&Y.emergencyContact.name&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Emergency Contact"}),e.jsxs("div",{className:"text-sm p-3 bg-muted rounded",children:[e.jsx("div",{className:"font-medium",children:Y.emergencyContact.name}),e.jsx("div",{className:"text-muted-foreground",children:Y.emergencyContact.relationship}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(v,{className:"h-3 w-3 mr-1"}),Y.emergencyContact.phone]})]})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsxs(r,{className:"flex-1",size:"sm",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),"Schedule"]}),e.jsxs(r,{variant:"outline",className:"flex-1",size:"sm",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Records"]})]})]})]}):e.jsx(l,{children:e.jsx(c,{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Select a patient to view details"})]})})})})]})]})};export{B as PatientList};
